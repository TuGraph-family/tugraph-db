<!doctype html>
<html lang="en-US" dir="ltr" class="docs-wrapper plugin-docs plugin-id-4-3-0_en docs-version-current docs-doc-page docs-doc-id-olap&procedure/learn/tutorial" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.5.2">
<title data-rh="true">Learning Tutorial | TuGraph 文档中心</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://tugraph.tech/tugraph-db/en-US/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://tugraph.tech/tugraph-db/en-US/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://tugraph.tech/tugraph-db/en-US/en/4.3.0/olap&amp;procedure/learn/tutorial"><meta data-rh="true" property="og:locale" content="en_US"><meta data-rh="true" property="og:locale:alternate" content="zh_CN"><meta data-rh="true" name="docusaurus_locale" content="en-US"><meta data-rh="true" name="docsearch:language" content="en-US"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-4-3-0_en-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-4-3-0_en-current"><meta data-rh="true" property="og:title" content="Learning Tutorial | TuGraph 文档中心"><meta data-rh="true" name="description" content="This document is designed as a guide for TuGraph users. Before reading the detailed documentation, users should first read this document to have a general understanding of the graph learning process of TuGraph, which will make it easier to read the detailed documentation later. The guide program is based on a simple program instance of TuGraph, and we will focus on its usage."><meta data-rh="true" property="og:description" content="This document is designed as a guide for TuGraph users. Before reading the detailed documentation, users should first read this document to have a general understanding of the graph learning process of TuGraph, which will make it easier to read the detailed documentation later. The guide program is based on a simple program instance of TuGraph, and we will focus on its usage."><link data-rh="true" rel="icon" href="https://mdn.alipayobjects.com/huamei_qcdryc/afts/img/A*AbamQ5lxv0IAAAAAAAAAAAAADgOBAQ/original"><link data-rh="true" rel="canonical" href="https://tugraph.tech/tugraph-db/en-US/en/4.3.0/olap&amp;procedure/learn/tutorial"><link data-rh="true" rel="alternate" href="https://tugraph.tech/tugraph-db/en/4.3.0/olap&amp;procedure/learn/tutorial" hreflang="zh-CN"><link data-rh="true" rel="alternate" href="https://tugraph.tech/tugraph-db/en-US/en/4.3.0/olap&amp;procedure/learn/tutorial" hreflang="en-US"><link data-rh="true" rel="alternate" href="https://tugraph.tech/tugraph-db/en/4.3.0/olap&amp;procedure/learn/tutorial" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://DGYVABHR0M-dsn.algolia.net" crossorigin="anonymous"><link rel="search" type="application/opensearchdescription+xml" title="TuGraph 文档中心" href="/tugraph-db/en-US/opensearch.xml">

















<meta name="algolia-site-verification" content="FC204AA054194DE3"><link rel="stylesheet" href="/tugraph-db/en-US/assets/css/styles.ce6a6631.css">
<script src="/tugraph-db/en-US/assets/js/runtime~main.38cb1eaf.js" defer="defer"></script>
<script src="/tugraph-db/en-US/assets/js/main.16003d39.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/tugraph-db/en-US/"><div class="navbar__logo"><img src="https://mdn.alipayobjects.com/huamei_qcdryc/afts/img/A*AbamQ5lxv0IAAAAAAAAAAAAADgOBAQ/original" alt="Tugraph Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="https://mdn.alipayobjects.com/huamei_qcdryc/afts/img/A*AbamQ5lxv0IAAAAAAAAAAAAADgOBAQ/original" alt="Tugraph Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/TuGraph-family/tugraph-db" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search (Command+K)"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="docsearch-wrapper" style="display:flex;justify-content:center;flex-direction:column"><div style="display:flex;justify-content:space-between;margin-bottom:8px"><div class="itemWrapper"><div class="titleBlock"><span class="titleText">TuGraph DB</span><div class="downIcon"></div></div><div class="contentArea"><span id="engineDescription">Community</span><span class="versionLabel">V<!-- -->4.3.0</span></div></div><div class="searchWrapper"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search (Command+K)"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/tugraph-db/en-US/en/4.3.0/guide">Guide</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/tugraph-db/en-US/en/4.3.0/introduction/what-is-graph">introduction</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/tugraph-db/en-US/en/4.3.0/quick-start/preparation">quick-start</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/tugraph-db/en-US/en/4.3.0/user-guide/tugraph-browser">user-guide</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/tugraph-db/en-US/en/4.3.0/installation&amp;running/environment">installation&amp;running</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/tugraph-db/en-US/en/4.3.0/utility-tools/data-import">utility-tools</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/tugraph-db/en-US/en/4.3.0/client-tools/python-client">client-tools</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/tugraph-db/en-US/en/4.3.0/query/cypher">query</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/tugraph-db/en-US/en/4.3.0/olap&amp;procedure/procedure">olap&amp;procedure</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/tugraph-db/en-US/en/4.3.0/olap&amp;procedure/procedure">TuGraph Stored Procedure Guide</a><button aria-label="Expand sidebar category &#x27;TuGraph Stored Procedure Guide&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/tugraph-db/en-US/en/4.3.0/olap&amp;procedure/olap/tutorial">olap</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/tugraph-db/en-US/en/4.3.0/olap&amp;procedure/learn/tutorial">learn</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/tugraph-db/en-US/en/4.3.0/olap&amp;procedure/learn/tutorial">Learning Tutorial</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/tugraph-db/en-US/en/4.3.0/olap&amp;procedure/learn/sampling_api">Sampling API</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/tugraph-db/en-US/en/4.3.0/olap&amp;procedure/learn/training">Training</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/tugraph-db/en-US/en/4.3.0/olap&amp;procedure/learn/heterogeneous_graph">Heterogeneous Graph</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/tugraph-db/en-US/en/4.3.0/permission/privilege">permission</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/tugraph-db/en-US/en/4.3.0/quality/unit-testing">quality</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/tugraph-db/en-US/en/4.3.0/contributor-manual/contributing">contributor-manual</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/tugraph-db/en-US/en/4.3.0/best-practices/rdbms-to-tugraph">best-practices</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/tugraph-db/en-US/en/4.3.0/faq">FAQ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/tugraph-db/en-US/en/4.3.0/contacts">Contacts</a></li></ul></nav></div></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/tugraph-db/en-US/en/guide"><div style="color:#1a1b2572">Docs</div></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">olap&amp;procedure</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">learn</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Learning Tutorial</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Learning Tutorial</h1></header>
<blockquote>
<p>This document is designed as a guide for TuGraph users. Before reading the detailed documentation, users should first read this document to have a general understanding of the graph learning process of TuGraph, which will make it easier to read the detailed documentation later. The guide program is based on a simple program instance of TuGraph, and we will focus on its usage.</p>
</blockquote>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="1-introduction-to-tugraph-graph-learning-module">1. Introduction to TuGraph Graph Learning Module<a href="#1-introduction-to-tugraph-graph-learning-module" class="hash-link" aria-label="Direct link to 1. Introduction to TuGraph Graph Learning Module" title="Direct link to 1. Introduction to TuGraph Graph Learning Module">​</a></h2>
<p>Graph learning is a machine learning method that utilizes the topological information of a graph structure to analyze and model data. Unlike traditional machine learning methods, graph learning uses graph structures where vertices represent entities in data and edges represent relationships between entities. By extracting features and patterns from these vertices and edges, deep associations and patterns can be revealed in data that can be used in various practical applications.</p>
<p>The TuGraph Graph Learning Module is a graph learning module based on a graph database that provides four sampling operators: Neighbor Sampling, Edge Sampling, Random Walk Sampling, and Negative Sampling. These operators can be used to sample vertices and edges in a graph to generate training data. The sampling process is performed in a parallel computing environment, providing high efficiency and scalability.</p>
<p>After sampling, the obtained training data can be used to train a model that can be used for various graph learning tasks such as prediction and classification. Through training, the model can learn the relationships between vertices and edges in the graph, allowing for prediction and classification of new vertices and edges. In practical applications, this module can be used to handle large-scale graph data such as social networks, recommendation systems, and bioinformatics.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="2-run-process">2. Run Process<a href="#2-run-process" class="hash-link" aria-label="Direct link to 2. Run Process" title="Direct link to 2. Run Process">​</a></h2>
<p>The TuGraph graph learning module samples graph data in TuGraph, and the sampled vertices and edges are used as graph learning features for learning and training. The operation process is shown in the figure below:</p>
<p><img decoding="async" loading="lazy" alt="Alt text" src="/tugraph-db/en-US/assets/images/learn_flow_chart_en-4a77be5d31e739c6855f132fdc7bcd8a.png" width="746" height="984" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="3-tugraph-compilation-and-data-preparation">3. TuGraph compilation and data preparation<a href="#3-tugraph-compilation-and-data-preparation" class="hash-link" aria-label="Direct link to 3. TuGraph compilation and data preparation" title="Direct link to 3. TuGraph compilation and data preparation">​</a></h2>
<p>For TuGraph compilation, please refer to: <a href="/tugraph-db/en-US/en/4.3.0/installation&amp;running/compile">Compile</a>
Execute in the build/output directory:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cp -r ../../test/integration/data/ ./ &amp;&amp; cp -r ../../learn/examples/* ./</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This command copies the relevant files of the dataset to the build/output directory.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="4-data-import">4. Data Import<a href="#4-data-import" class="hash-link" aria-label="Direct link to 4. Data Import" title="Direct link to 4. Data Import">​</a></h2>
<p>Please refer to <a href="/tugraph-db/en-US/en/4.3.0/utility-tools/data-import">Data Import</a> for data import.</p>
<p>Taking the cora dataset as an example for the import process:</p>
<p>Execute in the build/output directory:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">./lgraph_import -c ./data/algo/cora.conf --dir ./coradb --overwrite 1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Where cora.conf is the graph schema file representing the format of the graph data. coradb is the imported graph data file name representing the storage location of the graph data.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="5-feature-conversion">5. Feature Conversion<a href="#5-feature-conversion" class="hash-link" aria-label="Direct link to 5. Feature Conversion" title="Direct link to 5. Feature Conversion">​</a></h2>
<p>Since the features in graph learning are generally represented as long float arrays, TuGraph does not support loading float array types, so they can be imported as string types and converted to char* for subsequent storage and access, and the implementation details can refer to the feature_float.cpp file.</p>
<p>The specific execution process is as follows:</p>
<p>Compile the imported plugin in the build directory.（Skip if TuGraph has been compiled）:</p>
<p><code>make feature_float_embed</code></p>
<p>Execute in the build/output directory:</p>
<p><code>./algo/feature_float_embed ./coradb</code></p>
<p>Then the conversion can be performed.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="6-sampling-operators-and-compilation">6. Sampling Operators and Compilation<a href="#6-sampling-operators-and-compilation" class="hash-link" aria-label="Direct link to 6. Sampling Operators and Compilation" title="Direct link to 6. Sampling Operators and Compilation">​</a></h2>
<p>TuGraph implements an operator for obtaining the full graph data and four sampling operators at the cython layer, as follows:</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="61sampling-operator-introduction">6.1.Sampling Operator Introduction<a href="#61sampling-operator-introduction" class="hash-link" aria-label="Direct link to 6.1.Sampling Operator Introduction" title="Direct link to 6.1.Sampling Operator Introduction">​</a></h3>





























<table><thead><tr><th>Sampling Operator</th><th>Sampling Method</th></tr></thead><tbody><tr><td>GetDB</td><td>Get the graph data from the database and convert it into the required data structure</td></tr><tr><td>Neighbor Sampling</td><td>Sample the neighboring nodes of the given node to obtain the sampling subgraph</td></tr><tr><td>Edge Sampling</td><td>Sample the edges in the graph according to the sampling rate to obtain the sampling subgraph</td></tr><tr><td>Random Walk Sampling</td><td>Conduct a random walk based on the given node to obtain the sampling subgraph</td></tr><tr><td>Negative Sampling</td><td>Generate a subgraph of non-existent edges</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="62compilation">6.2.Compilation<a href="#62compilation" class="hash-link" aria-label="Direct link to 6.2.Compilation" title="Direct link to 6.2.Compilation">​</a></h3>
<p>Skip if TuGraph has been compiled.
Execute in the tugraph-db/build folder:</p>
<p><code>make -j2</code></p>
<p>Or execute in the tugraph-db/learn/procedures folder:</p>
<p><code>python3 setup.py build_ext -i</code></p>
<p>Once the algorithm so is obtained, it can be used by importing it in Python.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="7-model-training-and-storage">7. Model Training and Storage<a href="#7-model-training-and-storage" class="hash-link" aria-label="Direct link to 7. Model Training and Storage" title="Direct link to 7. Model Training and Storage">​</a></h2>
<p>TuGraph calls the cython layer operator at the Python layer to implement graph learning and training.</p>
<p>The usage of the TuGraph graph learning module is as follows:</p>
<p>Execute in the build/output folder:</p>
<p><code>python3 train_full_cora.py --model_save_path ./cora_model</code></p>
<p>Then training can be performed.</p>
<p>If the final printed loss value is less than 0.9, the training is successful. So far, the graph model training is completed, and the model is saved in the cora_model file.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="8-model-loading">8. Model Loading<a href="#8-model-loading" class="hash-link" aria-label="Direct link to 8. Model Loading" title="Direct link to 8. Model Loading">​</a></h2>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">model </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> build_model</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">model</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">load_state_dict</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">torch</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">load</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">model_save_path</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">model</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">eval</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Before using a saved model, it is necessary to load it first. In the code above, the trained model is loaded using the provided code.</p>
<p>After loading the model, we can use it to make predictions and classifications for new vertices and edges. For prediction, we can input one or multiple vertices and the model will output corresponding prediction results. For classification, we can input the whole graph, and the model will classify the vertices and edges in the graph to achieve the task goal.</p>
<p>Using a trained model can save time and resources compared to retraining the model. Additionally, since the model has already learned the relationships between vertices and edges in the graph, it can adapt well to new data and improve the accuracy of predictions and classifications.</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/tugraph-db/en-US/en/4.3.0/olap&amp;procedure/olap/algorithms"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">TuGraph Built-in Algorithm Description</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/tugraph-db/en-US/en/4.3.0/olap&amp;procedure/learn/sampling_api"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Sampling API</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#1-introduction-to-tugraph-graph-learning-module" class="table-of-contents__link toc-highlight">1. Introduction to TuGraph Graph Learning Module</a></li><li><a href="#2-run-process" class="table-of-contents__link toc-highlight">2. Run Process</a></li><li><a href="#3-tugraph-compilation-and-data-preparation" class="table-of-contents__link toc-highlight">3. TuGraph compilation and data preparation</a></li><li><a href="#4-data-import" class="table-of-contents__link toc-highlight">4. Data Import</a></li><li><a href="#5-feature-conversion" class="table-of-contents__link toc-highlight">5. Feature Conversion</a></li><li><a href="#6-sampling-operators-and-compilation" class="table-of-contents__link toc-highlight">6. Sampling Operators and Compilation</a><ul><li><a href="#61sampling-operator-introduction" class="table-of-contents__link toc-highlight">6.1.Sampling Operator Introduction</a></li><li><a href="#62compilation" class="table-of-contents__link toc-highlight">6.2.Compilation</a></li></ul></li><li><a href="#7-model-training-and-storage" class="table-of-contents__link toc-highlight">7. Model Training and Storage</a></li><li><a href="#8-model-loading" class="table-of-contents__link toc-highlight">8. Model Loading</a></li></ul></div></div></div></div></main></div></div></div></div>
</body>
</html>