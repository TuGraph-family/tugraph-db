"use strict";(self.webpackChunkdocusaurus=self.webpackChunkdocusaurus||[]).push([[43281],{78335:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>s,contentTitle:()=>i,default:()=>p,frontMatter:()=>o,metadata:()=>l,toc:()=>d});var t=n(74848),a=n(28453);const o={},i="TuGraph Java SDK",l={id:"client-tools/java-client",title:"TuGraph Java SDK",description:"1.Compile java client code",source:"@site/versions/version-4.2.0/en-US/source/7.client-tools/3.java-client.md",sourceDirName:"7.client-tools",slug:"/client-tools/java-client",permalink:"/tugraph-db/en-US/en/4.2.0/client-tools/java-client",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:3,frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"TuGraph C++ SDK",permalink:"/tugraph-db/en-US/en/4.2.0/client-tools/cpp-client"},next:{title:"TuGraph-OGM",permalink:"/tugraph-db/en-US/en/4.2.0/client-tools/tugraph-ogm"}},s={},d=[{value:"1.Compile java client code",id:"1compile-java-client-code",level:2},{value:"2.Demo",id:"2demo",level:2},{value:"2.1.Instantiate the client object",id:"21instantiate-the-client-object",level:3},{value:"2.1.1.Instantiate a single node client object",id:"211instantiate-a-single-node-client-object",level:4},{value:"2.1.2.Instantiate the HA cluster to directly connect to the client object",id:"212instantiate-the-ha-cluster-to-directly-connect-to-the-client-object",level:4},{value:"2.1.3.Instantiate the HA cluster to indirectly connect to the client object",id:"213instantiate-the-ha-cluster-to-indirectly-connect-to-the-client-object",level:4},{value:"2.2.Call cypher",id:"22call-cypher",level:3},{value:"2.3. Send cypher request to leader",id:"23-send-cypher-request-to-leader",level:3},{value:"2.4. Call GQL",id:"24-call-gql",level:3},{value:"2.5. Send GQL request to leader",id:"25-send-gql-request-to-leader",level:3},{value:"2.6. Calling stored procedures",id:"26-calling-stored-procedures",level:3},{value:"2.7. Call the stored procedure to the leader",id:"27-call-the-stored-procedure-to-the-leader",level:3},{value:"2.8. Load stored procedure",id:"28-load-stored-procedure",level:3},{value:"2.9. List stored procedures",id:"29-list-stored-procedures",level:3},{value:"2.10. Delete stored procedures",id:"210-delete-stored-procedures",level:3},{value:"2.11. Import schema from byte stream",id:"211-import-schema-from-byte-stream",level:3},{value:"2.12. Import edge data from byte stream",id:"212-import-edge-data-from-byte-stream",level:3},{value:"2.13. Import schema from file",id:"213-import-schema-from-file",level:3},{value:"2.14. Import point and edge data from file",id:"214-import-point-and-edge-data-from-file",level:3}];function c(e){const r={code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",p:"p",pre:"pre",...(0,a.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r.header,{children:(0,t.jsx)(r.h1,{id:"tugraph-java-sdk",children:"TuGraph Java SDK"})}),"\n",(0,t.jsx)(r.h2,{id:"1compile-java-client-code",children:"1.Compile java client code"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-shell",children:"cd deps/tugraph-db-client-java\nsh local_build.sh\n"})}),"\n",(0,t.jsx)(r.h2,{id:"2demo",children:"2.Demo"}),"\n",(0,t.jsx)(r.h3,{id:"21instantiate-the-client-object",children:"2.1.Instantiate the client object"}),"\n",(0,t.jsx)(r.p,{children:"Introduce dependencies"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-java",children:"import com.antgroup.tugraph.TuGraphDbRpcClient;\n"})}),"\n",(0,t.jsx)(r.h4,{id:"211instantiate-a-single-node-client-object",children:"2.1.1.Instantiate a single node client object"}),"\n",(0,t.jsx)(r.p,{children:"When starting the server in single-node mode, the client is instantiated in the following format"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-java",children:'TuGraphDbRpcClient client = new TuGraphDbRpcClient("127.0.0.1:19099", "admin", "73@TuGraph");\n'})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{children:"public TuGraphDbRpcClient(String url, String user, String pass)\n@param url: tugraph host looks like ip:port\n@param user: login user name\n@param password: login password\n"})}),"\n",(0,t.jsx)(r.h4,{id:"212instantiate-the-ha-cluster-to-directly-connect-to-the-client-object",children:"2.1.2.Instantiate the HA cluster to directly connect to the client object"}),"\n",(0,t.jsx)(r.p,{children:"When the HA cluster deployed on the server can be directly connected using the URL configured in ha_conf, the client is instantiated according to the following format"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-java",children:'TuGraphDbRpcClient client = new TuGraphDbRpcClient("127.0.0.1:19099", "admin", "73@TuGraph");\n'})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{children:"public TuGraphDbRpcClient(String url, String user, String pass)\n@param url: tugraph host looks like ip:port\n@param user: login user name\n@param password: login password\n"})}),"\n",(0,t.jsx)(r.p,{children:"The user only needs to pass in the url of any node in the HA cluster, and the client will automatically maintain the connection pool based on the query information returned by the server, and there is no need to manually restart the client when the HA cluster expands horizontally."}),"\n",(0,t.jsx)(r.h4,{id:"213instantiate-the-ha-cluster-to-indirectly-connect-to-the-client-object",children:"2.1.3.Instantiate the HA cluster to indirectly connect to the client object"}),"\n",(0,t.jsx)(r.p,{children:"When the HA cluster deployed on the server cannot use the URL configured in ha_conf to connect directly but must use an indirect URL (such as the Alibaba Cloud public network URL), the client is instantiated according to the following format."}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-java",children:'List<String> urls = new ArrayList<>();\nurls.add("189.33.97.23:9091");\nurls.add("189.33.97.24:9091");\nurls.add("189.33.97.25:9091");\nTuGraphDbRpcClient client = new TuGraphDbRpcClient(urls, "admin", "73@TuGraph");\n'})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{children:"public TuGraphDbRpcClient(List<String> urls, String user, String password)\n@param urls: tugraph host list\n@param user: login user name\n@param password: login password\n"})}),"\n",(0,t.jsx)(r.p,{children:"Because the URL that the user connects to is different from the information configured when the server starts, the client connection pool cannot be automatically updated by sending a request to the cluster, so it is necessary to manually pass in the URLs of all nodes in the cluster when starting the client, and when the cluster node changes Manually restart the client."}),"\n",(0,t.jsx)(r.h3,{id:"22call-cypher",children:"2.2.Call cypher"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-java",children:'    String res = client.callCypher("CALL db.edgeLabels()", "default", 10);\n    log.info("db.edgeLabels() : " + res);\n'})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{children:"    @param cypher: inquire statement.\n    @param graph: the graph to query.\n    @param timeout: Maximum execution time, overruns will be interrupted\n    @param url: (Optional) Node address of calling cypher\n    @return: the result of cypher query execution\n    public String callCypher(String cypher, String graph, double timeout, String url)\n"})}),"\n",(0,t.jsx)(r.p,{children:"This interface supports use in stand-alone mode and HA mode. Among them, in the client in HA mode, a read request can be directed to a server by specifying the url parameter.\nNote: JAVA does not support default parameters, therefore, default parameters in JAVA are implemented using overloaded functions."}),"\n",(0,t.jsx)(r.h3,{id:"23-send-cypher-request-to-leader",children:"2.3. Send cypher request to leader"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-java",children:'     String res = client.callCypherToLeader("CALL db.edgeLabels()", "default", 10);\n     log.info("db.edgeLabels() : " + res);\n'})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{children:"     @param cypher: inquire statement.\n     @param graph: the graph to query.\n     @param timeout: Maximum execution time, overruns will be interrupted\n     @return: the result of cypher query execution\n     public String callCypherToLeader(String cypher, String graph, double timeout)\n"})}),"\n",(0,t.jsx)(r.p,{children:"This interface only supports use in HA mode. In the client in HA mode, in order to prevent requests from being sent to followers with unsynchronized data,\nUsers can directly send requests to the leader, and the leader is elected by the cluster."}),"\n",(0,t.jsx)(r.h3,{id:"24-call-gql",children:"2.4. Call GQL"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-java",children:'     String res = client.callGql("CALL db.edgeLabels()", "default", 10);\n     log.info("db.edgeLabels() : " + res);\n'})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{children:"     @param gql: inquire statement.\n     @param graph: the graph to query.\n     @param timeout: Maximum execution time, overruns will be interrupted\n     @param url: (Optional) Node address of calling GQL\n     @return: the result of GQL query execution\n     public String callGql(String gql, String graph, double timeout, String url)\n"})}),"\n",(0,t.jsx)(r.p,{children:"This interface supports use in stand-alone mode and HA mode. Among them, in the client in HA mode, a read request can be directed to a server by specifying the url parameter.\nNote: JAVA does not support default parameters, therefore, default parameters in JAVA are implemented using overloaded functions."}),"\n",(0,t.jsx)(r.h3,{id:"25-send-gql-request-to-leader",children:"2.5. Send GQL request to leader"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-java",children:'     String res = client.callGqlToLeader("CALL db.edgeLabels()", "default", 10);\n     log.info("db.edgeLabels() : " + res);\n'})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{children:"     @param gql: inquire statement.\n     @param graph: the graph to query.\n     @param timeout: Maximum execution time, overruns will be interrupted\n     @return: the result of cypher query execution\n     public String callGqlToLeader(String cypher, String graph, double timeout)\n"})}),"\n",(0,t.jsx)(r.p,{children:"This interface only supports use in HA mode. In the client in HA mode, in order to prevent requests from being sent to followers with unsynchronized data,\nUsers can directly send requests to the leader, and the leader is elected by the cluster."}),"\n",(0,t.jsx)(r.h3,{id:"26-calling-stored-procedures",children:"2.6. Calling stored procedures"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-java",children:'     String result = client.callProcedure("CPP", "khop", kHopParamGen(), 1000, false, "default");\n     log.info("testCallProcedure : " + result);\n'})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{children:"     @param procedureType: the procedure type, currently supported CPP and PY\n     @param procedureName: procedure name\n     @param param: the execution parameters\n     @param procedureTimeOut: Maximum execution time, overruns will be interrupted\n     @param inProcess: Running query or not\n     @param graph: the graph to query\n     @param jsonFormat: (Optional) Return format of calling stored procedure\n     @param url: (Optional) Node address of calling procedure\n     @return: the result of procedure execution\n     public String callProcedure(String procedureType, String procedureName, String param, double procedureTimeOut,\n             boolean inProcess, String graph, String url)\n"})}),"\n",(0,t.jsx)(r.p,{children:"This interface supports use in stand-alone mode and HA mode. By default, the execution result of the stored procedure is directly returned in string format. Specifying jsonFormat as true can return the execution result in json format.\nAmong them, in the client in HA mode, a read request can be directed to a server by specifying the url parameter."}),"\n",(0,t.jsx)(r.h3,{id:"27-call-the-stored-procedure-to-the-leader",children:"2.7. Call the stored procedure to the leader"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-java",children:'     String result = client.callProcedureToLeader("CPP", "khop", kHopParamGen(), 1000, false, "default");\n     log.info("testCallProcedureToLeader : " + result);\n'})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{children:"     @param procedureType: the procedure type, currently supported CPP and PY\n     @param procedureName: procedure name\n     @param param: the execution parameters\n     @param procedureTimeOut: Maximum execution time, overruns will be interrupted\n     @param inProcess: Running query or not\n     @param graph: the graph to query\n     @param jsonFormat: (Optional) Return format of calling stored procedure\n     @return: the result of procedure execution\n     public String callProcedureToLeader(String procedureType, String procedureName, String param, double procedureTimeOut,\n             boolean inProcess, String graph)\n"})}),"\n",(0,t.jsx)(r.p,{children:"This interface supports use in HA mode. By default, the execution result of the stored procedure is directly returned in string format. Specifying jsonFormat as true can return the execution result in json format."}),"\n",(0,t.jsx)(r.h3,{id:"28-load-stored-procedure",children:"2.8. Load stored procedure"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-java",children:'     boolean result = client.loadProcedure("./test/procedure/khop.so", "CPP", "khop", "SO", "test loadprocedure", true, "v1", "default");\n     log.info("loadProcedure : " + result);\n'})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{children:"     @param sourceFile: the source_file contains procedure code\n     @param procedureType: the procedure type, currently supported CPP and PY\n     @param procedureName: procedure name\n     @param codeType: code type, currently supported PY, SO, CPP, ZIP\n     @param procedureDescription: procedure description\n     @param readOnly: procedure is read only or not\n     @param version: The version of procedure\n     @param graph: the graph to query.\n     @return: the result of procedure execution\n     public boolean loadProcedure(String sourceFile, String procedureType, String procedureName, String codeType,\n                               String procedureDescription, boolean readOnly, String version, String graph) throws Exception\n"})}),"\n",(0,t.jsx)(r.p,{children:"This interface supports use in stand-alone mode and HA mode. Among them, since loading a stored procedure is a write request, the client in HA mode can only send a request to load a stored procedure to the leader."}),"\n",(0,t.jsx)(r.h3,{id:"29-list-stored-procedures",children:"2.9. List stored procedures"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-java",children:'     String result = client.listProcedures("CPP", "any", "default");\n     log.info("listProcedures : " + result);\n'})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{children:"     @param procedureType: the procedure type, currently supported CPP and PY\n     @param version: The version of procedure\n     @param graph: the graph to query.\n     @param url: (Optional) Node address of listing procedure\n     @return: the list of procedures\n     public String listProcedures(String procedureType, String version, String graph, String url) throws Exception\n"})}),"\n",(0,t.jsx)(r.p,{children:"This interface supports use in stand-alone mode and HA mode. Among them, in the client in HA mode, a read request can be directed to a server by specifying the url parameter."}),"\n",(0,t.jsx)(r.h3,{id:"210-delete-stored-procedures",children:"2.10. Delete stored procedures"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-java",children:'     String result = client.deleteProcedure("CPP", "sortstr", "default");\n     log.info("loadProcedure : " + result);\n'})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{children:"     @param procedureType: the procedure type, currently supported CPP and PY\n     @param procedureName: procedure name\n     @param graph: the graph to query.\n     @return: the result of procedure execution\n     public boolean deleteProcedure(String procedureType, String procedureName, String graph) throws Exception\n"})}),"\n",(0,t.jsx)(r.p,{children:"This interface supports use in stand-alone mode and HA mode. Among them, since deleting a stored procedure is a write request, the client in HA mode can only send a delete request to the leader."}),"\n",(0,t.jsx)(r.h3,{id:"211-import-schema-from-byte-stream",children:"2.11. Import schema from byte stream"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-java",children:'     boolean ret = client.importSchemaFromContent(schema, "default", 1000);\n     log.info("importSchemaFromContent : " + ret);\n'})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{children:"     @param schema: the schema to be imported\n     @param graph: the graph to query.\n     @param timeout: Maximum execution time, overruns will be interrupted\n     @return: the result of import schema\n     public boolean importSchemaFromContent(String schema, String graph, double timeout) throws UnsupportedEncodingException\n"})}),"\n",(0,t.jsx)(r.p,{children:"This interface supports use in stand-alone mode and HA mode. Among them, since importing schema is a write request, the client in HA mode can only send an import schema request to the leader."}),"\n",(0,t.jsx)(r.h3,{id:"212-import-edge-data-from-byte-stream",children:"2.12. Import edge data from byte stream"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-java",children:'     boolean ret = client.importDataFromContent(personDesc, person, ",", true, 16, "default", 1000);\n     log.info("importDataFromContent : " + ret);\n'})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{children:"     @param desc: data format description\n     @param data: the data to be imported\n     @param delimiter: data separator\n     @param continueOnError: whether to continue when importing data fails\n     @param threadNums: maximum number of threads\n     @param graph: the graph to query.\n     @param timeout: Maximum execution time, overruns will be interrupted\n     @return: the result of import data\n     public boolean importDataFromContent(String desc, String data, String delimiter, boolean continueOnError,\n             int threadNums, String graph, double timeout) throws UnsupportedEncodingException\n"})}),"\n",(0,t.jsx)(r.p,{children:"This interface supports use in stand-alone mode and HA mode. Among them, since importing point and edge data is a write request, the client in HA mode can only send a request to import point and edge data to the leader."}),"\n",(0,t.jsx)(r.h3,{id:"213-import-schema-from-file",children:"2.13. Import schema from file"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-java",children:'     boolean ret = client.importSchemaFromFile("./test/data/yago.conf", "default", 1000);\n     log.info("importSchemaFromFile : " + ret);\n'})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{children:"     @param schemaFile: the schema_file contains schema\n     @param graph: the graph to query.\n     @param timeout: Maximum execution time, overruns will be interrupted\n     @return: the result of import schema\n     public boolean importSchemaFromFile(String schemaFile, String graph, double timeout)\n             throws UnsupportedEncodingException, IOException\n"})}),"\n",(0,t.jsx)(r.p,{children:"This interface supports use in stand-alone mode and HA mode. Among them, since importing schema is a write request, the client in HA mode can only send an import schema request to the leader."}),"\n",(0,t.jsx)(r.h3,{id:"214-import-point-and-edge-data-from-file",children:"2.14. Import point and edge data from file"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-java",children:'     boolean ret = client.importDataFromFile("./test/data/yago.conf", ",", true, 16, 0, "default", 1000000000);\n     log.info("importDataFromFile : " + ret);\n'})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{children:"     @param confFile: data file contains format description and data\n     @param delimiter: data separator\n     @param continueOnError: whether to continue when importing data fails\n     @param threadNums: maximum number of threads\n     @param skipPackages: skip packages number\n     @param graph: the graph to query.\n     @param timeout: Maximum execution time, overruns will be interrupted\n     @return: the result of import data\n     public boolean importDataFromFile(String confFile, String delimiter, boolean continueOnError, int threadNums,\n             int skipPackages, String graph, double timeout) throws IOException, UnsupportedEncodingException\n"})}),"\n",(0,t.jsx)(r.p,{children:"This interface supports use in stand-alone mode and HA mode. Among them, since importing point and edge data is a write request, the client in HA mode can only send a request to import point and edge data to the leader."})]})}function p(e={}){const{wrapper:r}={...(0,a.R)(),...e.components};return r?(0,t.jsx)(r,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}},28453:(e,r,n)=>{n.d(r,{R:()=>i,x:()=>l});var t=n(96540);const a={},o=t.createContext(a);function i(e){const r=t.useContext(o);return t.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function l(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:i(e.components),t.createElement(o.Provider,{value:r},e.children)}}}]);