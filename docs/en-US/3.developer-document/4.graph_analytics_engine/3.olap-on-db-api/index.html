<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../../../../img/favicon.ico" />
    <title>OLAP on DB API - TuGraph Documentation</title>
    <link rel="stylesheet" href="../../../../css/theme.css" />
    <link rel="stylesheet" href="../../../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "OLAP on DB API";
        var mkdocs_page_input_path = "en-US\\3.developer-document\\4.graph_analytics_engine\\3.olap-on-db-api.md";
        var mkdocs_page_url = null;
      </script>
    
    <script src="../../../../js/jquery-3.6.0.min.js" defer></script>
    <!--[if lt IE 9]>
      <script src="../../../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
      <script>hljs.initHighlightingOnLoad();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../../../.." class="icon icon-home"> TuGraph Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../..">Home</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">en-US</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="#">Guide</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../1.guide/1.what-is-graph/">What is Graph</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../1.guide/2.what-is-GDBMS/">What is GDBMS</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../1.guide/3.quick-start/">Quick Start</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="#">Operating</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../2.operating/1.introduce/">Introduction</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../2.operating/2.Install/">Install</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../2.operating/3.data-import/">Data Import</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../2.operating/4.server-config/">Server Config</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../2.operating/5.operation/">Operation</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../2.operating/7.ha-mode/">HA Mode</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../2.operating/8.manage-database/">Manage Database</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../2.operating/9.privilege/">Privilege</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="#">Tools</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../../2.operating/6.tools/1.tugraph-cypher/">TuGraph Cypher</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../../2.operating/6.tools/2.tugraph-browser/">TuGraph Browser</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../../2.operating/6.tools/3.tugraph-datax/">TuGraph DataX</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../../2.operating/6.tools/4.tugraph-explore/">TuGraph Explore</a>
                </li>
    </ul>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">Developer Document</a>
    <ul class="current">
                <li class="toctree-l2"><a class="reference internal" href="../../1.restful-api/">RESTful API</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../2.cypher/">Cypher</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../3.procedure/">Procedure</a>
                </li>
                <li class="toctree-l2 current"><a class="reference internal current" href="#">Graph Analytics Engine</a>
    <ul class="current">
                <li class="toctree-l3"><a class="reference internal" href="../1.tutorial/">Tutorial</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../2.olap-base-api/">OLAP Base API</a>
                </li>
                <li class="toctree-l3 current"><a class="reference internal current" href="./">OLAP on DB API</a>
    <ul class="current">
    <li class="toctree-l4"><a class="reference internal" href="#1-introduction">1. Introduction</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#2-schema">2. Schema</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#3-algorithm-example">3. Algorithm example</a>
    </li>
    </ul>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../4.olap-on-disk-api/">OLAP on Disk API</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../5.algorithms/">Algorithms</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../6.python-api/">Python API</a>
                </li>
    </ul>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="#">Client</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../4.client/1.java-client/">Java Client</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../4.client/2.python-client/">Python Client</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../4.client/3.cpp-client/">CPP Client</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="#">Supplement</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../5.supplement/changelog/">Changelog</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="#">Community</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../6.community/1.contributing/">Contributing</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../6.community/2.membership/">Membership</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../6.community/3.roadmap/">Roadmap</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../6.community/4.individual_cla/">Individual CLA</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../6.community/5.corporate_cla/">Corporate CLA</a>
                </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">zh-CN</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="#">指南</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../../zh-CN/1.guide/1.what-is-graph/">什么是图</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../../zh-CN/1.guide/2.what-is-GDBMS/">什么是 GDBMS</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../../zh-CN/1.guide/3.quick-start/">快速入门</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="#">操作</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../../zh-CN/2.operating/1.introduce/">介绍</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../../zh-CN/2.operating/2.Install/">安装</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../../zh-CN/2.operating/3.data-import/">数据导入</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../../zh-CN/2.operating/4.server-config/">服务器配置</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../../zh-CN/2.operating/5.operation/">运维</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../../zh-CN/2.operating/7.ha-mode/">高可用模式</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../../zh-CN/2.operating/8.manage-database/">管理数据库</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../../zh-CN/2.operating/9.privilege/">权限</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../../zh-CN/2.operating/10.resource-monitoring/">资源监控</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../../zh-CN/2.operating/11.integration-test/">集成测试</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="#">工具</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../../../zh-CN/2.operating/6.tools/1.tugraph-cypher/">TuGraph Cypher</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../../../zh-CN/2.operating/6.tools/2.tugraph-browser/">TuGraph Browser</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../../../zh-CN/2.operating/6.tools/3.tugraph-datax/">TuGraph DataX</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../../../zh-CN/2.operating/6.tools/4.tugraph-explore/">TuGraph Explore</a>
                </li>
    </ul>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="#">开发者文档</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../../zh-CN/3.developer-document/1.restful-api/">RESTful API</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../../zh-CN/3.developer-document/2.cypher/">Cypher</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../../zh-CN/3.developer-document/3.procedure/">Procedure</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="#">图分析引擎</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../../../zh-CN/3.developer-document/4.graph_analytics_engine/1.tutorial/">教程</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../../../zh-CN/3.developer-document/4.graph_analytics_engine/2.olap-base-api/">OLAP 基本 API</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../../../zh-CN/3.developer-document/4.graph_analytics_engine/3.olap-on-db-api/">OLAP 在数据库上的 API</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../../../zh-CN/3.developer-document/4.graph_analytics_engine/4.olap-on-disk-api/">OLAP 在磁盘上的 API</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../../../zh-CN/3.developer-document/4.graph_analytics_engine/5.algorithms/">算法</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../../../zh-CN/3.developer-document/4.graph_analytics_engine/6.python-api/">Python API</a>
                </li>
    </ul>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="#">客户端</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../../zh-CN/4.client/1.java-client/">Java 客户端</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../../zh-CN/4.client/2.python-client/">Python 客户端</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../../zh-CN/4.client/3.cpp-client/">CPP 客户端</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../../zh-CN/4.client/4.java-ogm/">Java OGM</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="#">补充</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../../zh-CN/5.supplement/changelog/">更新日志</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="#">社区</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../../zh-CN/6.community/1.contributing/">参与贡献</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../../zh-CN/6.community/2.membership/">成员资格</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../../zh-CN/6.community/3.roadmap/">路线图</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../../zh-CN/6.community/4.individual_cla/">个人 CLA</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../../zh-CN/6.community/5.corporate_cla/">企业 CLA</a>
                </li>
    </ul>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../..">TuGraph Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../../.." class="icon icon-home" alt="Docs"></a> &raquo;</li>
          <li>en-US &raquo;</li>
          <li>Developer Document &raquo;</li>
          <li>Graph Analytics Engine &raquo;</li>
      <li>OLAP on DB API</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="olapondb-api">OlapOnDB API</h1>
<blockquote>
<p>This document provides detailed instructions for using the OlapOnDB API</p>
</blockquote>
<h3 id="1-introduction">1. Introduction</h3>
<p>Generally speaking, users need to implement the process of subgraph extraction by themselves. Then use the rich interface in TuGraph to implement your own graph analysis algorithm.</p>
<p>This document mainly introduces the Procedure and Embed interface design, and introduces some common interface, specific interface information see include/lgraph/olap_on_db.h file.</p>
<h3 id="2-schema">2. Schema</h3>
<p>Procedure and Embed auxiliary functions are mainly included in the OlapOnDB class, and some more frequently used functions will be introduced one by one</p>
<p>OLAP is associated with the following common data structures in TuGraph:</p>
<ol>
<li>
<p>DB graph analysis class <code>OlapOnDB</code></p>
</li>
<li>
<p>Vertex array <code>ParallelVector</code></p>
</li>
<li>
<p>Vertex set <code>ParallelBitset</code></p>
</li>
<li>
<p>Side data structure <code>AdjUnit/AdjUnit</code></p>
</li>
<li>
<p>Edge collection data structure <code>AdjList</code></p>
</li>
</ol>
<h4 id="21-snapshot-based-storage-structure">2.1 Snapshot Based Storage Structure</h4>
<p>The OlapOnDB class in TuGraph provides a data "snapshot," that is, a fully usable copy of a given data set that includes a mirror image of the corresponding data at a certain point in time (the point at which the copy was started). Because OLAP operations involve only reads and not writes, OlapOnDB arranges data in a more compact manner, saving space while improving data access locality.</p>
<h4 id="22-bsp-calculation-model">2.2 BSP Calculation Model</h4>
<p>TuGraph uses the BSP (Bulk Synchronous Parallel) model in the process of calculation, which makes the process can be executed in parallel, and greatly improves the efficiency of the program.</p>
<p>The core idea of BSP calculation model is to propose and use Super Step. After OlapOnDB is created, the computation on this data is divided into multiple supersteps, such as PageRank, which is divided into multiple iterations, and each iteration is a Super Step. There is explicit synchronization between different Super Steps to ensure that all threads proceed to the next Super Step at the same time after completing the same superstep. Within a Super Step, all threads execute asynchronously, using parallelism to improve computational efficiency.</p>
<p>BSP calculation model can effectively avoid deadlock, and achieve coarse-grained global synchronization in hardware mode by means of obstacle synchronization, so that graph computation can be executed in parallel, and programmers do not need to spend much time on synchronization mutual exclusion.</p>
<h3 id="3-algorithm-example">3. Algorithm example</h3>
<p>Here is an explanation of the PageRank algorithm, which is mainly divided into the main function Process and the PageRank algorithm process function.</p>
<h4 id="31-main-function">3.1 Main function</h4>
<p>The main function has three input parameters, 'TuGraph' database parameter 'db', the request 'request' obtained from the web side, and the return value 'response' given to the web side. The overall process can be divided into the following steps:</p>
<ol>
<li>
<p>Obtain related parameters</p>
</li>
<li>
<p>Create a snapshot class</p>
</li>
<li>
<p>Main process of PageRank algorithm</p>
</li>
<li>
<p>Obtain and send the return value of the web page</p>
</li>
</ol>
<pre><code class="language-c">extern &quot;C&quot; bool Process(GraphDB &amp; db, const std::string &amp; request, std::string &amp; response) {

    // Obtain the number of iterations from web side requests (num_iterations)，
    int num_iterations = 20;
    try {
        json input = json::parse(request);
        num_iterations = input[&quot;num_iterations&quot;].get&lt;int&gt;();
    } catch (std::exception &amp; e) {
        throw std::runtime_error(&quot;json parse error&quot;);
        return false;
    }

    // Read transaction creation and snapshot class creation
    auto txn = db.CreateReadTxn();
    OlapOnDB&lt;Empty&gt; olapondb(
        db,
        txn,
        SNAPSHOT_PARALLEL
    );

    // Create a pr array to store the pr value for each node
    ParallelVector&lt;double&gt; pr = olapondb.AllocVertexArray&lt;double&gt;();
    // pagerank algorithm main process, obtain the pagerank value of each node
    PageRankCore(olapondb, num_iterations, pr);

    auto all_vertices = olapondb.AllocVertexSubset();
    all_vertices.Fill();
    /*
        Function Purpose: Gets the number of the node with the largest pagerank among all nodes

        Function flow description: This function executes Func A for node vi (also known as the active vertices) corresponding to all bits of 1 in the vertex set all_vertices. The return value of Func A is then used as the second input parameter of Func B to obtain the local maximum value (because the first input parameter is 0. So the return value is actually the pagerank value of each node). Finally, the return value of all threads is summarized, and Func B is executed again to get the global return value, and stored in the max_pr_vi variable
    */
    size_t max_pr_vi = olapondb.ProcessVertexActive&lt;size_t&gt;(

        //Func A
        [&amp;](size_t vi) {
            return vi;
        },
        all_vertices,
        0,

        //Func B
        [&amp;](size_t a, size_t b) {
            return pr[a] &gt; pr[b] ? a : b;
        }
    );

    // Retrieve and send the return value from the web page
    json output;
    output[&quot;max_pr_vid&quot;] = olapondb.OriginalVid(max_pr_vi);
    output[&quot;max_pr_val&quot;] = pr[max_pr_vi];
    response = output.dump();
    return true;
}
</code></pre>
<h4 id="32-pagerank-algorithm-process">3.2 PageRank Algorithm process</h4>
<p><code>pagerank</code> main process has two input parameters, snapshot class (subgraph) and iteration times, the overall process can be divided into the following steps:</p>
<ol>
<li>Initialization of related data structures</li>
<li>Initialize the pagerank value of each node</li>
<li>Calculation of pagerank value of each node, active vertices for all vertices (means that all vertices need to calculate pagerank value)</li>
<li>Obtain the pagerank value after 'num_iterations' of each node</li>
</ol>
<pre><code class="language-c">void PageRankCore(OlapBase&lt;Empty&gt;&amp; graph, int num_iterations, ParallelVector&lt;double&gt;&amp; curr) {

    // Initialization of related data structures
    auto all_vertices = olapondb.AllocVertexSubset();
    all_vertices.Fill();
    auto curr = olapondb.AllocVertexArray&lt;double&gt;();
    auto next = olapondb.AllocVertexArray&lt;double&gt;();
    size_t num_vertices = olapondb.NumVertices();
    double one_over_n = (double)1 / num_vertices;

    // The initialization of the pagerank value of each node is inversely proportional to the degree of the node
    double delta = graph.ProcessVertexActive&lt;double&gt;(
        [&amp;](size_t vi) {
            curr[vi] = one_over_n;
            if (olapondb.OutDegree(vi) &gt; 0) {
                curr[vi] /= olapondb.OutDegree(vi);
            }
            return one_over_n;
        },
        all_vertices);

    // Total iteration process
    double d = (double)0.85;
        for (int ii = 0;ii &lt; num_iterations;ii ++) {
        printf(&quot;delta(%d)=%lf\n&quot;, ii, delta);
        next.Fill((double)0);

        /*
            Function Purpose: Calculates the pagerank of all nodes

            Function flow description: This function is used to calculate the pagerank value of all nodes. Execute Func C on node vi corresponding to all the bits of 1 in all_vertices to obtain the pagerank value of vi in the current iteration and return the pagerank change value of vi node. The total change value of all active nodes is finally summarized and returned through the internal processing of the function, which is stored in the delta variable
        */
        delta = graph.ProcessVertexActive&lt;double&gt;(
            // Func C
            [&amp;](size_t vi) {
                double sum = 0;

                // Gets the pagerank value of the current node from its neighbor
                for (auto &amp; edge : olapondb.InEdges(vi)) {
                    size_t src = edge.neighbour;
                    sum += curr[src];
                }
                next[vi] = sum;

                // pagerank value calculation core formula
                next[vi] = (1 - d) * one_over_n + d * next[vi];
                if (ii == num_iterations - 1) {
                    return (double)0;
                } else {

                    // Statistics of relevant intermediate variables
                    if (olapondb.OutDegree(vi) &gt; 0) {
                        next[vi] /= olapondb.OutDegree(vi);
                        return fabs(next[vi] - curr[vi]) * olapondb.OutDegree(vi);
                    } else {
                        return fabs(next[vi] - curr[vi]);
                    }
                }
            },
            all_vertices
        );

        // The pagerank value obtained in this iteration is output as the input of the next iteration
        curr.Swap(next);
    }
}
</code></pre>
<h4 id="41-transaction-creation">4.1 Transaction creation</h4>
<pre><code class="language-c">// Create a read transaction
auto txn = db.CreateReadTxn();

// Write transaction creation
auto txn = db.CreateWriteTxn();
</code></pre>
<h4 id="42-parallelization-to-create-a-directed-graph">4.2 Parallelization to create a directed graph</h4>
<pre><code class="language-c">OlapOnDB&lt;empty&gt; olapondb(&lt;/empty&gt;
db,
txn,
SNAPSHOT_PARALLEL
)
</code></pre>
<h4 id="43-create-undirected-graphs-in-parallel">4.3 Create undirected graphs in parallel</h4>
<pre><code class="language-c">OlapOnDB&lt;empty&gt; olapondb(&lt;/empty&gt;
db,
txn,
SNAPSHOT_PARALLEL | SNAPSHOT_UNDIRECTED;
)
</code></pre>
<h4 id="44-obtain-the-output-degree">4.4 Obtain the output degree</h4>
<pre><code class="language-c">size_t OutDegree(size_t vid)
</code></pre>
<h4 id="45-obtain-the-input-degree">4.5 Obtain the input degree</h4>
<pre><code class="language-c">size_t InDegree(size_t vid)
</code></pre>
<h4 id="46-gets-the-outgoing-edge-set">4.6 Gets the outgoing edge set</h4>
<pre><code class="language-c">/*
    Function name: AdjList OutEdges(size_t vid)

    Data structure:

    An AdjList can be understood as an array of structures of type AdjUnit

    AdjUnit has two member variables: 1. size_t neighbour 2. edge_data: neighbour indicates the number of the target node pointed by the outgoing edge. If the value is a licensed graph, the data type of edge_data is the same as the weight value of the edge in the input file

    Example Output all outgoing neighbors of node vid
*/
for (auto &amp; edge : olapondb.OutEdges(vid)) {
    size_t dst = edge.neighbour;
    printf(&quot;src = %lu,dst = %lu\n&quot;,vid,dst);
}
</code></pre>
<h4 id="47-gets-the-incoming-edge-set">4.7 Gets the incoming edge set</h4>
<pre><code class="language-c">AdjList&lt;edgedata&gt; InEdges(size_t vid)&lt;/edgedata&gt;

// Example: Outputs all inbound neighbors of node vid
for (auto &amp; edge : olapondb.InEdges(vid)) {
size_t dst = edge.neighbour;
printf(&quot;src = %lu,dst = %lu\n&quot;,vid,dst);
}
</code></pre>
<h4 id="48-get-the-node-id-of-olapondb-corresponding-to-the-node-in-tugraph">4.8 Get the node ID of OlapOnDB corresponding to the node in TuGraph</h4>
<pre><code class="language-c">size_t OriginalVid(size_t vid)

// Note: The node numbers entered in TuGraph can be non-numbers, such as names. When OlapOnDB subgraphs are generated, names and other names will be converted to numbers for subsequent processing. Therefore, this method may not be applicable to some specific scenarios
</code></pre>
<h4 id="49-gets-the-node-number-of-tugraph-corresponding-to-a-node-in-olapondb">4.9 Gets the node number of TuGraph corresponding to a node in OlapOnDB</h4>
<pre><code class="language-c">size_t MappedVid(size_t original_vid)
</code></pre>
<h4 id="410-description-of-active-vertices">4.10 Description of active vertices</h4>
<p>Active vertices refer to the vertices that need to be processed in the batch function. In this example, we simply output the number of active vertices and summarize the number of active vertices:</p>
<pre><code class="language-c">ParallelBitset temp = 000111; // The current active vertices are vertices 3, 4 and 5

size_t delta = ForEachActiveVertex&lt;double&gt;(&lt;/double&gt;
//void c
[&amp;](size_t vi) {
printf(&quot;active_vertexId = %lu\n&quot;,vi);
return 1;
},
all_vertices
);
</code></pre>
<p>The result of this function is obvious. Because of multiple threads, the output order may vary:</p>
<pre><code>active_vertexId = 3
active_vertexId = 4
active_vertexId = 5
</code></pre>
<p>The local return value is 1. This function will add all the local return values in a thread-safe manner to the final return value, which is stored in the delta variable, and the final value is 3</p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../2.olap-base-api/" class="btn btn-neutral float-left" title="OLAP Base API"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../4.olap-on-disk-api/" class="btn btn-neutral float-right" title="OLAP on Disk API">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../2.olap-base-api/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../4.olap-on-disk-api/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script>var base_url = '../../../..';</script>
    <script src="../../../../js/theme_extra.js" defer></script>
    <script src="../../../../js/theme.js" defer></script>
      <script src="../../../../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
